title: 开源项目：删除微博工具
categories: PHP##分类
tags: [开源,PHP]##标签，多标签格式为 [tag1,tag2,...]
keywords: 开源,PHP##文章关键词，多关键词格式为 keyword1,keywords2,...
description: 自己造轮子删微博
date: 2016/09/17 14:24:25 
---
# 介绍

利用该工具可以实现删除个人所有微博功能，不用受到第三方调用API次数限制
不能保证工具长期有效

GITHUB地址: https://github.com/kong36088/DeleteWeiboTool

# 使用方法

配置好代码根目录下的`Config/config.php`中要求必填的项目
`$config['sina_cookie'] `：登陆好后，打开F12开发者工具获取REQUEST中的cookie值填入
`$config['self_page_url'] `：打开开发者工具设置模拟IPHONE6访问页面`m.weibo.cn`,点击查看我的所有微博，复制页面URL

然后开始运行
``` bash
cd /xxx/xxx/DelWeibo
php Delete.php
``` 

设置教程如下
![设置](/uploads/DelWeibo0.png)
![效果图1](/uploads/DelWeibo1.png)

<!--more-->

![效果图2](/uploads/DelWeibo2.png)
![效果图3](/uploads/DelWeibo3.png)
![效果图4](/uploads/DelWeibo4.png)


# 总结

1.尽量模拟好所有的header，包括host，referer等

2.在个人服务器上经常会出现504 GATEWAY错误，具体设置是加大nginx中的buffersize以及PHP max_childrend的大小

3.关于PHP CURL中post数据需要注意的地方：
如果$data是字符串，则Content-Type是application/x-www-form-urlencoded。

HTML Form URL Encoded: application/x-www-form-urlencoded

Form item: "uname" = "nickname"

Key: uname

Value: nickname

如果$data是k=>v的数组，则Content-Type是multipart/form-data,

4.模拟登陆可以采用手动登陆后直接获取到浏览器的cookie每次登陆采用该cookie，`curl_setopt($ch, CURLOPT_COOKIE, $this->cookie)`

5.出现乱码等情况时可以加入gzip解析，`curl_setopt($ch, CURLOPT_ENCODING, 'gzip')`
